%% PLOTTING ANALYITICAL, EXPERIMENTAL FFT and EXPERIMENTAL PWELCH DATA:

%% 1) S_v

figure;  
loglog(w_e, S_V_off_e, '--', w_e, S_V_on_e, '--', 'LineWidth',1)
hold on;
loglog(w_p, S_V_off_p, w_p, S_V_on_p, 'LineWidth',2)
hold on;
loglog(w_a, S_V_off_a, w_a, S_V_on_a, 'LineWidth',2);
legend('Experimental FFT - Pitch damper OFF', ...
       'Experimental FFT - Pitch damper ON',...
       'Experimental PWELCH - Pitch damper OFF', ...
       'Experimental PWELCH - Pitch damper ON',...
       'Anaytic - Pitch damper OFF', ...
       'Anaytic - Pitch damper ON'); 
grid; title('Velocity - ALL PSDs'); ylabel('S_{VV}'); xlabel('log w');

%% 2) S_alpha

figure;  
loglog(w_e, S_alpha_off_e, '--', w_e, S_alpha_on_e, '--', 'LineWidth',1)
hold on;
loglog(w_p, S_alpha_off_p, w_p, S_alpha_on_p, 'LineWidth',2)
hold on;
loglog(w_a, S_alpha_off_a, w_a, S_alpha_on_a, 'LineWidth',2);
legend('Experimental FFT - Pitch damper OFF', ...
       'Experimental FFT - Pitch damper ON',...
       'Experimental PWELCH - Pitch damper OFF', ...
       'Experimental PWELCH - Pitch damper ON',...
       'Anaytic - Pitch damper OFF', ...
       'Anaytic - Pitch damper ON'); 
grid; title('Angle of attack PSD'); ylabel('S_{\alpha\alpha}'); xlabel('log w');

%% 3) S_theta

figure;  
loglog(w_e, S_theta_off_e, '--', w_e, S_theta_on_e, '--', 'LineWidth',1)
hold on;
loglog(w_p, S_theta_off_p, w_p, S_theta_on_p, 'LineWidth',2)
hold on;
loglog(w_a, S_theta_off_a, w_a, S_theta_on_a, 'LineWidth',2);
legend('Experimental FFT - Pitch damper OFF', ...
       'Experimental FFT - Pitch damper ON',...
       'Experimental PWELCH - Pitch damper OFF', ...
       'Experimental PWELCH - Pitch damper ON',...
       'Anaytic - Pitch damper OFF', ...
       'Anaytic - Pitch damper ON'); 
grid; title('Pitch angle PSD'); ylabel('S_{\theta\theta}'); xlabel('log w');

%% S_q

figure;  
loglog(w_e, S_q_off_e, '--', w_e, S_q_on_e, '--', 'LineWidth',1)
hold on;
loglog(w_p, S_q_off_p, w_p, S_theta_on_p, 'LineWidth',2)
hold on;
loglog(w_a, S_q_off_a, w_a, S_theta_on_a, 'LineWidth',2);
legend('Experimental FFT - Pitch damper OFF', ...
       'Experimental FFT - Pitch damper ON',...
       'Experimental PWELCH - Pitch damper OFF', ...
       'Experimental PWELCH - Pitch damper ON',...
       'Anaytic - Pitch damper OFF', ...
       'Anaytic - Pitch damper ON'); 
grid; title('Pitch rate PSD'); ylabel('S_{qq}'); xlabel('log w');

%% S_N

figure;  
loglog(omega, movmean(S_N_off_e, p), '--', omega, movmean(S_N_on_e, p), '--', 'LineWidth',2)
hold on;
loglog(PW_w_uncont, S_N_off_p, PW_w_cont, S_N_on_p)
hold on;
loglog(w, S_N_off_a, w, S_N_on_a, 'LineWidth',2);
legend('Experimental FFT - Pitch damper OFF', ...
       'Experimental FFT - Pitch damper ON',...
       'Experimental PWELCH - Pitch damper OFF', ...
       'Experimental PWELCH - Pitch damper ON',...
       'Anaytic - Pitch damper OFF', ...
       'Anaytic - Pitch damper ON'); 
grid; title('Load factor PSD'); ylabel('S_{NN}'); xlabel('log w');
